## 查询优化
### 查询处理概述
![](./7pic/1.jpg)
>+ 1. 根据给定SQL查询进行语法分析生成语法分析树
>+ 2. 生成语法分析树后进行语法检查,查看是否存在非法查询(如查一个不存在的空表),并进行初始逻辑查询计划生成
>+ 3. 对于初始逻辑查询计划,根据查询转化规则进行查询重写(在数学上进行登记啊的转化),生成最佳逻辑查询计划
>+ 4. 根据最佳逻辑查询计划,生成物理查询计划
>+ 5. 对于所有可能的物理查询计划进行评估,选出最佳物理查询计划
>+ 6. 执行物理查询计划

####  本章内容:
>+ 语法分析(Parsing)
>+ 逻辑查询计划生成(Logical Query Plan)
>+ **查询重写(Query Rewrite)**
>+ **查询计划代价估计(Cost Estimation)**
>+ **物理查询计划选择(Physical Query Plan)**

PS:加粗表示本章重点

### 一、语法分析
主要用于构造语分析树,根据SQL查询语句,生成类似编译原理的抽象语法书(AST),不是重点两张PPT直接跳了

### 二、初始逻辑查询计划生成
#### 1.关系代数回顾
|操作符|含义|
|---|---|
|$\cup$|并|
|$\cap$|交|
|$\sigma$|选择|
|$\prod$|投影|
|$-$|差|
|$\bowtie$|自然连接(笛卡尔积)|
|$\bowtie_{A\theta B}$|Theta连接(当$\theta$ 为=时为等值连接)|
#### 2.关系代数与SQL
关系代数是SQL的**代数表达**
关系代数表达式可以与某个SQL进行对应
**NOTE:**
>+ 关系代数**基于集合**(SET)运算
>+ SQL**基于包**(BAG)运算(包可以理解为无序的多重集合)
>+ 集合:无重复元素,包:允许重复元素


### 三、查询重写
目的：将初始逻辑查询计划转换为优化的逻辑查询
计划(Maybe)
基于代数转化规则
#### 2、转换规则

