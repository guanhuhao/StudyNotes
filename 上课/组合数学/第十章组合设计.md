# 第十章 组合设计
**拉丁方:**
对于一个n*n的方阵,要求每行每列中1,2,...,n各出现一次,则称这样的方阵为n阶拉丁方
**正交拉丁方:**
设$A_1,A_2$是拉丁方,$A_1与A_2$正交当且仅当由这两个方阵生成的新方阵其$n^2$个数偶各不相同,例:
$$
\begin{aligned}
A_1 = 
\begin{bmatrix}
1&2&3\\
2&3&1\\
3&1&2
\end{bmatrix}
\,\,\,\,
A_2 = 
\begin{bmatrix}
1&3&2\\
2&1&3\\
3&2&1
\end{bmatrix}
\\
\\
(A_1,A_2) = 
\begin{bmatrix}
(1,1)&(2,3)&(3,2)\\
(2,2)&(3,1)&(1,3)\\
(3,3)&(1,2)&(2,1)
\end{bmatrix}
\end{aligned}
$$
显然经过对比之后$(A_1,A_2)$各元素要么第一位不同,要么第二位不同

## 10.2 平衡不完全区组设计
**区组设计定义:**
对于有限集合$S$,$B_1,B_2,...,B_b$是S的b个子集,则集组:
$$
\mathfrak{B}=\{B_1,B_2,...,B_b\}
$$
称之为一个设计的区组
**完全区组设计:**
如果对于S的全排列,且生成的矩阵$A$为拉丁方,则称这样的区组为完全区组设计
**平衡不完全区组设计(BIBD)**
对于$S=\{s_1,s_2,...,s_v\},\mathfrak{B}=\{B_1,B_2,...,B_b\}$如果$\mathfrak{B}$满足下面条件,则称$\mathfrak{B}$为平衡不完全区组设计,其参数为$(b,v,r,k,\lambda)$:
>+ $|B_1|=|B_2|=...=|B_b|=k$
>+ S中任何元素属于r个区组
>+ S中任何一对元组包含在$\lambda$区组中

平衡的含义:对于所有区组的**容量**$|B_i|$均相同,S中**任意元素出现次数**均相同,**任意一对元素**在设计中出现次数均相同

参数解释:
以女生问题举例:
安排15名女生散步,散步时3名女生一组,分成5组,问能够安排7次这样的散步,使得每对女生恰好一起散步一次
>+ $b:$区组容量,一个区组即一次散步,容量即多少人参加散步
>+ $v:$元素总数,即多少位女生
>+ $r:$元素重复次数,即一个人参加多少次散步
>+ $k:$组织多少次散步
>+ $\lambda:$每对女生一起散步的次数

特别的当$k=0,1,2,v-2,v-1,v$时其他四个参数可以直接由k推导出,因此此时称这些情况为平凡的

**对称平衡不完全区组设计:**
在平衡不完全区组设计的前提下额外要求$b=v,r=k$

**关联矩阵:**
对于平衡不完全区组设计,我们使用关联矩阵来描述刻画其性质,我们设$A$为其生成的关联矩阵,A中元素$a_{ij}$仅有0,1两种取值,并且当$a_{ij}$取值满足下面条件:
$$
a_{ij}=
\begin{cases}
1&(s_j\in B_i)\\
0&(s_j\not\in B_i)
\end{cases}
$$

### 相关定理:
下面我们列出一个关联矩阵,辅助分析:
||$s_1$|$s_2$|...|s_v|$\sum$|
|---|---|---|---|---|---|
|$B_1$|$a_{11}$|$a_{12}$|...|$a_{1v}$|k|
|$B_1$|$a_{21}$|$a_{22}$|...|$a_{2v}$|k|
|...|...|...|...|...|...|
|$B_1$|$a_{b1}$|$a_{b2}$|...|$a_{bv}$|k|
|$\sum$|$r$|$r$|$r$|$r$||
**定理10.2.1**
这样我们可以得到一个显然的结论,对于关联矩阵按行累加$bk$,等于按列累加$vr$,即:
$$
bk=vr
$$
物理意义:以女生问题为例,另一种解释可以理解为:所有女生散步次数的总和=每次参加人数*活动次数

$$
\lambda (v-1) = r(k-1)
$$
物理意义:这个式子稍作变形我们可以得到$\frac{\lambda (v-1)}{(k-1)}=r$,这样相当于对于女生a,除了a以外的(v-1)名同学与a都一起散步$\lambda$次,那么一共有$\lambda (v-1)$人$\cdot$次,而每次a参与的散步可以提供k-1人$\cdot$次的贡献,那么显然可以得到a散步的次数为上式

**定理10.2.2**
设A为关联矩阵
$$
A^TA=(r-\lambda)I_v+\lambda J_v
$$
即A的转置乘A,得到一个主对角线为r,其他元素为$\lambda$的矩阵
物理意义:对于结果第i行第j列元素,可以理解为第i位女生与第j位女生一起散步的次数,显然主对角线上元素,自己陪自己散步r次,根据定义与其他女生散步$\lambda$次


