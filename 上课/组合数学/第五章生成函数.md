# 生成函数
## 5.1 引论
对一个有限或者无限数列$\{a_0,a_1,a_2,...\}$,使用幂级数进行表示:
$$
A(x)=a_0+a_1x+a_2x^2+...
$$
将其使用幂级数进行表示之后,我们可以通过研究幂级数$A(x)$来导出${a_0,a_1,a_2,...}$的构造性质
如对与组合数的生成函数:
$$
\begin{aligned}
f_n(x)&=\binom{n}{0}+\binom{n}{1}x+\binom{n}{2}x^2+...+\binom{n}{n}x^n\\
&=(1+x)^n
\end{aligned}
$$
那么我们可以得出:
$$
\begin{aligned}
&\sum_{i=0}^{n}\binom{n}{i}=(1+1)^n=2^n\\
&\sum_{i=0}^{n}i*\binom{n}{i}=f_n'(x)=n*(1+1)^{n-1}=n*2^{n-1}
\end{aligned}
$$
同理范德蒙德恒等式可以由下面的生成函数生成:
$$
(1+x)^{m+n}=(1+x)^m(1+x)^n\\
\binom{m+n}{r}=\sum_{k=0}^r\binom{m}{k}\binom{n}{n-k}
$$

### 例1
**题意:** 一个骰子投10次,点数和为3的概率
首先有恒等式:
$$
(1-x^n)=(1-x)*(1+x+x^2+...x^{n-1})
$$
因此我们可以得到:
$$
1+x+x^2+...+x^n=\frac{1-x^{n+1}}{1-x}
$$
根据题意我们可以得到其生成函数:
$$
\begin{aligned}
&=(x+x^2+x^3+x^4+x^5+x^6)^{10}\\
&=(x(1+x+x^2+x^3+x^4+x^5))^{10}\\
&=x^{10}(1+x+x^2+x^3+x^4+x^5)^{10}\\
&=x^{10}(\frac{1-x^{6}}{1-x})^{10}\\
&=x^{10}\cdot \sum_{i=0}^{10}\binom{10}{i}x^{6i}\cdot \sum_{i=0}^{\infty}\binom{10-1+i}{i}x^i
\end{aligned}
$$

## 5.2 形式幂级数
对于幂级数$A(x),B(x)$定义下面运算:
>+ $A(x)+-B(x)=\sum(a_k+b_k)x^k$
>+ $\alpha A(x)=\sum{(\alpha a_k)x^k}$
>+ $A(x)B(x)=\sum{(a_0b_k+a_1b_{k-1}+...)x^k}$
>+ $A(x)/B(x)=多项式除法$

性质:上面定义的加法以及乘法运算,构成一个可交换含单位元(幺元),无零因子(零元)的环(即正环)

### 乘法逆元
对于形式幂级数$A(x)=\sum_{k=0}^\infty a_kx^k$有乘法逆元**当且仅当$a_0!=0**$,若设$\\{\tilde A(x)=\sum_{k=0}^{\infty}\tilde{a}_kx^k}$可用克莱姆法则求,一般使用待定系数法得到矩阵,然后进行求解.

### 形式倒数
对于任意A(x)=$A(x)=\sum_{k=0}^\infty a_kx^k$规定$DA(x)$为$A(x)$的形式倒数为:
$$
DA(x)=\sum_{k=1}^\infty ka_kx^{k-1}
$$
同时其倒数满足下面性质:
>+ $D[\alpha A(x)+\beta B{x}]=\alpha DA(x)+\beta DB(x)$
>+ $D[\alpha A(x)\cdot \beta B{x}]=A(x)DB(x)+DA(x)B(x)$
>+ $D[A^n(x)]=nA^{n-1}(x)DA(x)$

## 生成函数的性质
定义数列$\{a_0,a_1,a_2,...\}$生成函数为$A(x)=\sum_{k=0}^\infty a_kx^k$,数列${b_0,b_1,b_2,...}$的生产函数为$B(x)=\sum_{k=0}^\infty b_kx^k$
### 构造数列
#### 1.往右平移
则有:
$$
b_k=
\begin{cases}
0&(k<l)\\
a_{k-l}&(k\geq l)
\end{cases}
$$
那么显然我们可以得到:
$$
B(x)=x^l\cdot A(x)
$$

#### 2.往左平移
则有$b_k=a_{k+l}$那么我们可以得到下面的关系:
$$
B(x)=\frac{1}{x^t}[A(x)-\sum_{k=0}^{l-1}a_kx^k]
$$

### 构造函数前缀/后缀和
#### 3.前k项和
若$b_k=\sum_{i=0}^ka_i$则有:
$$
B(x)=\frac{A(x)}{1-x}
$$
**证明:**
将$b_k$带入,并展开,再等式两边求和提取公因式获得形似:
$$(a_0+a_1x+a_2x^2+...)(1+x+x^2+...)$$
将$\frac{1}{1-x}$的生成函数进行替换得到结果.

#### 4.后无穷项和
若$b_k=\sum_{i=k}^{\infty}a_i$则有:
$$
B(x)=\frac{A(1)-xA(x)}{1-x}
$$
**证明:**
与前k项和类似

### 与下标有关
#### 5.若$b_k=ka_k$
则有:
$$
B(x)=xA'(x)
$$

#### 6.若$b_k=\frac{a_k}{k+1}$
则有:
$$
B(x)=\frac{1}{x}\int^x_0{A(t) dt}
$$

### 四则运算
#### 7.线性组合
若$c_k=\alpha a_k +\beta b_k$,则有:
$$
C(x)=\sum_{k=0}^{\infty}c_kx^k=\alpha A(x)+\beta B(x)
$$

#### 8.对应系数逆序乘积
若$c_k=a_0b_k+a_1b_{k-1}+...+a_kb_0$,则有:
$$
C(x)=\sum_{k=0}^{\infty}c_kx^k=A(x)\cdot B(x)
$$

### 常用的生成函数:
#### 常数1的生成函数
$$G\{1\}=\frac{1}{1-x}$$
#### 常数的k次方生成函数(等比数列)
$$G\{a^k \}=\frac{1}{1-ax}$$
#### 常数k的生成函数
$$G\{k\}=\frac{x}{(1-x)^2}$$
使用构造序列的方法5可得
#### k*(k+1)的生成函数
$$G\{k(k+1)\}=\frac{2x}{(1-x)^3}$$
使用常数k的生成函数积分可得
#### k^2的生成函数
$$G\{k^2\}=\frac{x(1+x)}{(1-x)^3}$$
对常数k的生成函数使用构造序列方法5可得
#### k(k+1)(k+2)的生成函数
$$G\{k(k+1)(k+2)\}=\frac{6x^4}{1-x}$$
#### 阶乘倒数的生成函数
$$G\{\frac{1}{k!}\}=e^x$$
#### 组合数生成函数
$$G\{\binom{\alpha}{k}\}=(1+x)^\alpha$$
#### 另一种组合数的生成函数
$$G\{\binom{n+k}{k}\}=\frac{1}{(1-x)^{n+1}}$$

## 5.5 排列型分配问题的指数型生成函数
### 5.5.1 排列数的指数型生成函数
例如n元集合的k排列数为$n(n-1)...(n-k+1)$没有简单构造的生成函数解释表达式,但是我们可以使用$\frac{x^k}{k!}$代替则可以得到其下面的生成函数:
$$
\sum_{k=0}^mn(n-1)...(n-k+1)\cdot \frac{x^k}{k!}=(1+x)^n
$$
我们记:
$$
e(ax)=\sum a^k\frac{x^k}{k!}
$$
与指数函数类似有下面的性质:
$$
e(x)e(y)=e(x+y)\\
e(-x)=\frac{1}{e(x)}\\
e(0)=1
$$

## 5.6正整数的分拆
定义:正整数n的一个k分拆为把n表示成k个正整数的和,即:
$$
n=n_1+n_2+...+n_k (k\geq 1,n_i\geq 1)
$$

### 5.6.1 有序分拆
如果每个分部量($a_i$)有序,则针对下面几种限定条件下有下面的计数公式:

#### 正整数n的有序k分拆
正整数n的有序k分拆个数为$\binom{n-1}{k-1}$
该问题等价于:
$$
x_1+x_2+...+x_k=n
$$

#### 有限制的k拆分
要求第i个分部量大于等于$p_i$,方案数为:
$$
\binom{n+k-\sum_{i=1}^k(p_i-1)}{k-1}
$$
相当于预先分配每个分部量要求的个数再套用正整数n的有序k拆分

### 5.6.2 无序分拆
使用$B(n,k)$表示n的k分拆数,用B(n)表示n的所有分拆数,因此有下式:
$$
B(n,k)=0(k>n)\\
B(n)=\sum_{k=1}^nB(n,k)
$$
一般情况下,按照分部量降序排列,即对于:
$$
n=n_1+n_2+...+n_k\\
n_1\geq n_2\geq ...\geq n_k
$$
如果在分拆中有$k_i$个分部量为i,那么可以记为:
$$
n=k_1\cdot 1+k_2\cdot 2+...+k_n \cdot n \\
n=1^{k_1}2^{k_2}...n^{k_n}
$$

**定理5.6.3:** n的分拆数B(n,k)满足递推关系:
$$B(n+k,k)=B(n,1)+B(n+2)+....+B(n,k)$$
证明:对于n的不超过k的分拆数可以表示为$B(n,1)+B(n,2)+...+B(n,k)$通过给其k项都加1,可以构造一一对应的n+k的k分拆

### 5.6.3 Ferrers图
Ferrers为一个二维点阵,点数为n,每行/每列表示分拆的一个元素.
**共轭操作:** 行列互换
**定理5.6.4:** n的k分拆数,等于个数为n的最大分布量为k的分拆数(根据共轭性质)
**定理5.6.5:** n的自共轭分拆的个数等于n各分部都是奇数切两两不等的拆分个数
**定理5.6.6:** 最小分布量为1的k分拆数等于n-1的k-1分拆数 
**定理5.6.7:** 令$B(n)$表示正整数n的所有分拆数,则有:
$$\sum_{n=0}^\infty B_r(n)x^n=\frac{1}{(1-x)(1-x^2)...(1-x^n)}$$
证明:设幂级数乘积$(1+x+x^2...)[(1+x^2+(x^2)^2...)...(1+x^r+(x^r)^2...)]$,展开后可得$x^n=x^{k1+2k2+...+rkr}$
令$B_H(n)$表示各分部量属于集合H的分拆数,则有:
$$\sum_{n=0}^\infty B_r(n)x^n=$$


$$
ans = \sum_{y=0}^{\infty}\lfloor n-yk \rfloor
$$
